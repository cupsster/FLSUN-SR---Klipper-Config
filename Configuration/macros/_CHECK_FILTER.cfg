[gcode_macro _CHECK_FILTER]
description: Helper: Print filter exchange warning
gcode:
    {% if printer['gcode_macro _USER_VARIABLE'].hw.filter.ena and printer.save_variables.variables.print_stats %}
        {% set Fh = (printer.save_variables.variables.print_stats.time.filter / 3600)|int %}
        {% if Fh >= printer['gcode_macro _USER_VARIABLE'].peripheral.filter.warning %}
            M117 Change Filter!
            {action_respond_info("Change Filter material at printer filter!")}
            UPDATE_DELAYED_GCODE ID=_CLEAR_DISPLAY DURATION=10
        {% endif %}
    {% endif %}